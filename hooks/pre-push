#!/bin/bash
# Pre-push hook for PM projects
# This hook runs before pushing to remote repository

set -e

echo "🚀 Running pre-push checks..."

# Check if there are any uncommitted changes
if ! git diff --quiet; then
    echo "❌ Uncommitted changes found. Please commit or stash them."
    exit 1
fi

# Check if there are any unstaged changes
if ! git diff --cached --quiet; then
    echo "❌ Unstaged changes found. Please add and commit them."
    exit 1
fi

# Run a final build check
echo "🔨 Running final build check..."
if ! cargo build --release; then
    echo "❌ Release build failed. Please fix build errors."
    exit 1
fi

# Check if documentation builds
echo "📚 Checking documentation build..."
if ! cargo doc --no-deps --quiet; then
    echo "❌ Documentation build failed. Please fix doc errors."
    exit 1
fi

echo "✅ Pre-push checks passed!"